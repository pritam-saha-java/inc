<!DOCTYPE html>
<html
  lang="en"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:th="https://www.thymeleaf.org"
>
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
    />
    <link
      rel="icon"
      type="image/png"
      th:href="@{/server/assets/img/logo.png}"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap"
      rel="stylesheet"
    />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet" />
    
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://incallup.com/server/assets/styles/style.css"
    />
    <link rel="stylesheet" th:href="@{/server/assets/styles/nav.css}" />
    <link rel="stylesheet" th:href="@{/server/assets/styles/header.css}" />
    <link rel="stylesheet" th:href="@{/server/assets/styles/style.css}" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
      integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <!-- Google Recaptcha -->
  <script src="https://www.google.com/recaptcha/api.js" async defer></script>
    <link
      rel="stylesheet"
      href="https://incallup.com/server/assets/styles/reset.min.css"
    />
    <title>Create New Account</title>
    <script
      type="text/javascript"
      async
      defer
      src="https://maps.googleapis.com/maps/api/js?loading=async"
    ></script>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <style>
      .divider:after,
      .divider:before {
        content: "";
        flex: 1;
        height: 1px;
        background: #eee;
      }
      .h-custom {
        height: calc(100% - 73px);
      }
      @media (max-width: 450px) {
        .h-custom {
          height: 100%;
        }
      }
    </style>

    <style>
      body{
        font-family: 'Roboto';
      }
    </style>

  </head>

  <body>
    <div th:replace="dashboard.html :: siteHeader"></div>

    <div class="container border border-3 px-0 py-5 mt-5 mb-5">
      <div th:if="${login!=null}">
        <div th:text="login" class="text-center">Please Login First</div>
      </div>

      <!-- <h1 class="text-center my-5  ">Register For Free <img src="https://incallup.com/server/assets/img/logo.png" alt="site-logo"></h1> -->
      <!-- <div class="mt-3">
        <div class="row justify-content-center">
          <div class="col-auto">
            <div class="d-flex align-items-center">
              <h6 class="text-center my-5 site-text2">Register For Free</h6>
            </div>
          </div>
        </div>
      </div> -->

      <!-- <form class="  " id="signup">
        <div class="mb-4 row justify-content-center " >

            <input  class="form-control-lg col-6 col-md-8 col-sm-8 rounded-5" type="text" name="username" id="username" placeholder="Username">
        </div>
        <div class="mb-4 row justify-content-center " >

            <input  class="form-control-lg col-6 col-md-8 col-sm-8 rounded-5" type="text" name="email" id="email" placeholder="Email">
        </div>
        <div class="mb-4 row justify-content-center">

            <input class="form-control-lg col-6 col-md-8 col-sm-8 rounded-5 " type="password" name="password" id="password" placeholder="Password">
        </div>

        <div class="mb-4 row justify-content-center">

            <input class="form-control-lg col-6 col-md-8 col-sm-8 rounded-5 " type="password" name="confirm" id="confirm" placeholder="Confirm Password">
        </div>

        <div class="mb-4 row  justify-content-center ">

            <button type="submit" class="btn bg-pink col-6 text-light btn-lg rounded-5 ">Submit</button>
        </div>
    </form> -->

      <section class=" ">
        <div class="container-fluid h-custom">
          <div class="row d-flex justify-content-center align-items-center">
            <div class="col-md-8 col-lg-6 col-xl-4 offset-xl-1">
              <form id="signup">
                <div class="divider d-flex align-items-center">
                  Register For Free
                  <h3></h3>
                  <p class="text-center fw-bold mx-3 mb-0">
                   
                    <img
                      class="rounded rounded-4 mx-1"
                      style="
                        max-width: 10rem;
                        height: 3rem;
                        background-color: var(--pink);
                      "
                      src="https://incallup.com/server/assets/img/logo.png"
                      alt="site-logo"
                    />
                  </p>
                </div>

                <div class="container">
                  <!-- Username input -->
                  <div data-mdb-input-init class="form-outline mb-4">
                    <label class="form-label" for="form3Example3"
                      >Username</label
                    >
                    <input
                      class="form-control form-control-lg"
                      type="text"
                      name="username"
                      id="username"
                      placeholder="Enter Username"
                    />
                  </div>

                  <!-- Email input -->
                  <div data-mdb-input-init class="form-outline mb-4">
                    <label class="form-label" for="form3Example3"
                      >Email address</label
                    >
                    <input
                      type="text"
                      name="email"
                      id="email"
                      class="form-control form-control-lg"
                      placeholder="Enter a valid email address"
                    />
                  </div>

                  <!-- Password input -->
                  <div data-mdb-input-init class="form-outline mb-3">
                    <label class="form-label" for="form3Example4"
                      >Password</label
                    >

                    <input
                      type="password"
                      name="password"
                      id="password"
                      class="form-control form-control-lg"
                      placeholder="Enter password"
                    />
                  </div>

                  <!--Confirm Password input -->
                  <div data-mdb-input-init class="form-outline mb-3">
                    <label class="form-label" for="form3Example4"
                      > Confirm  Password</label
                    >

                    <input
                      type="password"
                      name="confirm"
                      id="confirm"
                      class="form-control form-control-lg"
                      placeholder="Confirm Password"
                    />
                  </div>

                  <!-- reCAPTCHA widget -->
              <div class="g-recaptcha" data-sitekey="6LfCKukpAAAAAEzqhmD8qOz3kUhoaZ8HyZ5gWgN4"></div>

                  <div class="text-center text-lg-start mt-4 pt-2">
                    <button
                      type="submit"
                      data-mdb-button-init
                      data-mdb-ripple-init
                      class="btn btn-primary btn-lg"
                      style="padding-left: 2.5rem; padding-right: 2.5rem"
                    >
                      Register
                    </button>
                    <p class="small fw-bold mt-2 pt-1 mb-0 mb-3">
                      Don't have an account?
                      <a href="https://incallup.com/login" class="link-danger"
                        >Login</a
                      >
                    </p>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </section>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>
    <script>
      var element = document.getElementById("signup");

      element.addEventListener("submit", (event) => {
        event.preventDefault();
        // TODO do something here to show user that form is being submitted

        var email = element.querySelector("#email").value;
        var password = element.querySelector("#password").value;
        var confirm = element.querySelector("#confirm").value;
        var username = element.querySelector("#username").value;

        const captchaResponse=grecaptcha.getResponse();

        if (!captchaResponse) {
          alert("Please complete the reCAPTCHA challenge.");
          return;
        }

        console.log(email.value);

        if (!email || !password || !confirm || !username) {
          alert("Please fill in all fields.");
          return;
        }
        
        if (confirm !== password) {
          alert("please match password with confirm password");
          return false;
        }

        // var reqBody =
        //   "email=" + email + "&password=" + password + "&username=" + username;
        var reqBody =
    "email=" + email + "&password=" + password + "&username=" + username + "&g-recaptcha-response=" + captchaResponse;

        var endpoint = "https://incallup.com/seller/create";
        var response = fetch(endpoint, {
          body: reqBody,
          headers: {
            "Content-Type": "application/x-www-form-urlencoded",
          },
          method: "post",
        }).then((response) => {
          if (response.status === 200) {
            alert("seller saved");
            window.location.href = "https://incallup.com/login";
          }
          else{
            alert("Error registering seller.");
          }
        })
        .catch((error)=>{
          console.error("Error registering seller:", error);
        })
        console.log(response.status);
      });
    </script>
    <script th:src="@{/server/assets/scripts/main.js}"></script>
    <script th:src="@{/server/assets/scripts/common.js}"></script>
  </body>
</html>
